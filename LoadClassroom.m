% is_dibr_do_refinement = false;

pics_dir = 'COLMAP-Classroom/';
if is_dibr_do_refinement == false
    depthColorRefinement(pics_dir); % 颜色图和深度图滤波 Color Depth Refinement
end

refined_dir_name = 'DepthColorRefinement/';
color_dir_name = 'Color/';
depth_dir_name = 'Depth/';
prc_dir_name = [pics_dir,refined_dir_name,color_dir_name];
prd_dir_name = [pics_dir,refined_dir_name,depth_dir_name];
pc_dir_name = [pics_dir, color_dir_name];
pd_dir_name = [pics_dir, depth_dir_name];

Zfar = 0.0;
Znear = 0.0;
Znears = {0.2078153520822525, 0.02085057731717825, 0.028140672445297242, 0.03934773549437523, 0.078728067278862, 2.543591260910034, 44.96107482910156, 7.938481330871582, 4.3868441486358645, 5.674726819992065, 4.833615674972534};
Zfars = {0.23185516595840452, 0.028107828199863436, 0.035564658492803575, 0.04684541940689087, 0.0859233120083809, 2.5494587421417236, 44.96541435241699, 7.9666989803314205, 4.4135198974609375, 5.702808523178101, 4.8612867450714115};

K_0 = [
    14633.483946058079 	 0	320
    0.0	2292.7025064976224	180
    0.0	0.0	1.0
    ];
K_1 = [
    1502.7607172896389  	 0	320
    0.0	194.6804919357856 	180
    0.0	0.0	1.0
    ];
K_2 = [
    2030.9257460038962  	 0	320
    0.0	263.03849423538026 	180
    0.0	0.0	1.0
    ];
K_3 = [
    2840.4272454511438  	 0	320
    0.0	367.60281201124241 	180
    0.0	0.0	1.0
    ];
K_4 = [
    5676.9513176649498  	 0	320
    0.0	734.91542154119929 	180
    0.0	0.0	1.0
    ];
K_5 = [
    183645.37922303446  	 0	320
    0.0	23733.903368102419 	180
    0.0	0.0	1.0
    ];
K_6 = [
    3287516.2447897531  	 0	320
    0.0	427298.10180252371 	180
    0.0	0.0	1.0
    ];
K_7 = [
   590599.3950700179  	 0	320
    0.0	148516.65916919179 	180
    0.0	0.0	1.0
    ];
K_8 = [
    331926.14539019216  	 0	320
    0.0	169534.10405813192 	180
    0.0	0.0	1.0
    ];
K_9 = [
    435862.4175287562  	 0	320
    0.0	347906.05361849337 	180
    0.0	0.0	1.0
    ];
K_10 = [
    376151.02947620268  	 0	320
    0.0	339191.15947641176 	180
    0.0	0.0	1.0
    ];


Rt_0 = getCOLMAPRt([0.96127010367662979 0.27549039493225091 0.0074027081617849414 0.0031670158612434663 -0.0059861033135971513 1.0555683742187441 -0.40173100175941406]);
Rt_1 = getCOLMAPRt([0.9999890331627147 -0.00073422367927940919 0.0045531221463909841 0.00081458492987679235 0.0016802898900464016 0.56577360763063955 -1.0631340684114821]);
Rt_2 = getCOLMAPRt([0.99999299230671435 -0.00081461389015500955 0.003580152605187709 0.0007309233867026949 0.0038856392032939782 0.56559250086011015 -1.0558991188938767]);
Rt_3 = getCOLMAPRt([0.99999403130987785 -0.0011125980297153741 0.0031980621107824893 0.00068692720052018232 0.0047638983613203121 0.56495058836781331 -1.0450283754965715]);
Rt_4 = getCOLMAPRt([0.99999732515146267 0.00050603610003803771 0.0021867512687242878 0.00055833347921395936 0.0071051690876135255 0.56845302930446917 -1.0038907507149506]);
Rt_5 = getCOLMAPRt([0.99998088477210967 -0.0057081140555098478 0.0023051255169929483 0.00057785869295813943 0.0068182139458676004 0.55493806535802925 1.4534226515568065]);
Rt_6 = getCOLMAPRt([0.99868611812376207 -0.05122531990839236 0.0014064083940161639 0.00016150109350650623 0.0091881424091044741 0.45343915627449644 43.825238131568454]);
Rt_7 = getCOLMAPRt([0.87825921969819165 0.47811483829973539 0.0070025341455443599 0.0042318941718603714 -0.0056626073133357342 1.2186333699069127 7.8404276824730399]);
Rt_8 = getCOLMAPRt([0.80118047452976837 0.59838744013491785 0.0048586514847856034 0.0043257631447745446 -0.002208495740948144 1.2007553876506893 4.638563128830361]);
Rt_9 = getCOLMAPRt([0.75279069300207335 -0.65823396403900281 0.0045408550331580855 -0.0036880551144104494 -0.00043806153248655101 -0.99892311026753489 4.9793669172260158]);
Rt_10= getCOLMAPRt([0.74658103148254584 -0.66527070074963324 0.0043629446648359776 -0.0035528676307056066 6.8211913699325074e-06 -1.0120140034371963 4.1571235768054926]);


Ks = {K_0, K_1, K_2, K_3, K_4, K_5, K_6, K_7, K_8, K_9, K_10};
Rts = {Rt_0, Rt_1, Rt_2, Rt_3, Rt_4, Rt_5, Rt_6, Rt_7, Rt_8, Rt_9, Rt_10};
